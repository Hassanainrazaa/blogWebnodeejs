<!DOCTYPE html>
<html lang="en">

<head>
    <%- include("partials/head.ejs") %> <!-- Including the head partial -->
    <title><%= blog.title %></title>
    <style>
        .blog-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
        }

        .blog-image {
            max-width: 300px;
            height: auto;
            margin-right: 30px;
            border-radius: 10px;
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
        }

        .blog-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #333;
            line-height: 1.2;
            border-bottom: 4px solid #007bff;
            display: inline-block;
        }

        .blog-body {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #555;
        }

        .author-info {
            display: flex;
            align-items: center;
            margin-top: 30px;
        }

        .author-info img {
            margin-right: 10px;
        }

        .comment-section {
            margin-top: 50px;
        }

        .comment-section h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .comment-box {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }

        .comment-box img {
            margin-right: 10px;
        }

        .comment-content {
            flex-grow: 1;
        }

        .comment-content strong {
            font-size: 1.1rem;
            color: #007bff;
        }

        .comment-content small {
            color: #888;
        }

        .add-comment-form input {
            border-radius: 5px;
        }
    </style>
</head>

<body class="text-wrap"> <!-- Apply text-wrap to the body to ensure wrapping -->
    <%- include("partials/navbar.ejs") %> <!-- Including the navbar partial -->

    <div class="container my-5">
        <div class="blog-container">
            <!-- Blog cover image on the left side -->
            <div>
                <img src="<%= blog.coverImageURL %>" alt="Blog Cover Image" class="img-fluid blog-image">
            </div>

            <!-- Blog title and content on the right side -->
            <div>
                <!-- Blog title -->
                <h1 class="blog-title mb-4"><%= blog.title %></h1>

                <!-- Blog body -->
                <div class="blog-body mb-5">
                    <p><%= blog.body %></p>
                </div>

                <!-- Author information -->
                <div class="author-info">
                    <img src="<%= blog.createdBy.profileImageURL %>" width="50px" class="rounded-circle me-2"
                        alt="Author Image">
                    <strong><%= blog.createdBy.fullname %></strong>
                </div>
            </div>
        </div>

        <!-- Comments Section -->
        <div class="comment-section mt-5">
            <h2>Comments (<%= comments.length %>)</h2>

            <!-- Show comment form if the user is logged in -->
            <% if (locals.user) { %>
                <form action="/blog/comment/<%= blog._id %>" method="post" class="mb-4 add-comment-form">
                    <div class="mb-3">
                        <input type="text" class="form-control" name="content" placeholder="Enter Your Comment">
                        <button class="btn btn-sm btn-primary mt-2" type="submit">Add</button>
                    </div>
                </form>
            <% } %>

            <!-- Display Comments -->
            <div class="comments-list">
                <% for (let i=0; i < comments.length; i++) { %>
                    <div class="comment-box d-flex align-items-start mb-3">
                        <img src="<%= comments[i].createdBy.profileImageURL %>" width="40px"
                            class="rounded-circle" alt="Commenter Image">
                        <div class="comment-content">
                            <strong><%= comments[i].createdBy.fullname %></strong>
                            <p class="mb-1"><%= comments[i].content %></p>
                            <small><%= new Date(comments[i].createdAt).toLocaleString() %></small>
                        </div>
                    </div>
                <% } %>
            </div>
        </div>
    </div>

    <%- include("partials/script.ejs") %> <!-- Including any additional scripts -->
</body>

</html>
